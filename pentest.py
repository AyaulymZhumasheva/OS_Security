import nmap
import requests


def gobuster_scan(ip, wordlist):
    with open(wordlist, 'r') as f:
        words = f.read().splitlines()
    print('************* CS-2124 Gobuster Scanner *************')
    print('')
    for word in words:
        target_url = f"http://{ip}/{word}"
        response = requests.get(target_url)
        if response.status_code == 200:
            print(f"Found: {target_url}")

def nmap_scan(target_host, target_ports):
    # Создаем объект сканера
    scanner = nmap.PortScanner()

    scan_result = scanner.scan(target_host, target_ports)
    print('************* CS-2124 Port Scanner *************')
    print('')
    # Обрабатываем результаты сканирования
    for target_host in scan_result['scan']:
        print('Host: %s' % target_host)
        for target_port in scan_result['scan'][target_host]['tcp']:
            port_status = scan_result['scan'][target_host]['tcp'][target_port]['state']
            print('Port: %s\tStatus: %s' % (target_port, port_status))

target_host = input("Введите IP-адрес для сканирования: ")
target_ports = '21,22,25,80,110,143,443,3389'  # Порты для сканирования (можно указать диапазон через дефис)
wordlist_file = 'wordlist.txt'

nmap_scan(target_host, target_ports)
gobuster_scan(target_host, wordlist_file)